<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>init</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="title" content="init"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2013-10-06T19:21+0100"/>
<meta name="author" content="Wilfred Hughes"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">init</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 Introduction</a>
<ul>
<li><a href="#sec-1-1">1.1 Licensing</a></li>
<li><a href="#sec-1-2">1.2 Reading This Document</a></li>
<li><a href="#sec-1-3">1.3 Generating This Document</a></li>
</ul>
</li>
<li><a href="#sec-2">2 Installing locally</a>
<ul>
<li><a href="#sec-2-1">2.1 The Git Repository</a></li>
<li><a href="#sec-2-2">2.2 Emacs 24</a></li>
<li><a href="#sec-2-3">2.3 Python</a></li>
<li><a href="#sec-2-4">2.4 JavaScript</a></li>
<li><a href="#sec-2-5">2.5 Less</a></li>
</ul>
</li>
<li><a href="#sec-3">3 Contents</a>
<ul>
<li><a href="#sec-3-1">3.1 Folder Structure</a></li>
<li><a href="#sec-3-2">3.2 Packages</a></li>
<li><a href="#sec-3-3">3.3 Paths</a></li>
<li><a href="#sec-3-4">3.4 UI</a>
<ul>
<li><a href="#sec-3-4-1">3.4.1 Theme</a></li>
<li><a href="#sec-3-4-2">3.4.2 Hiding and Showing</a></li>
<li><a href="#sec-3-4-3">3.4.3 Recursive Editing</a></li>
</ul>
</li>
<li><a href="#sec-3-5">3.5 Moving Around</a>
<ul>
<li><a href="#sec-3-5-1">3.5.1 By Symbol</a></li>
<li><a href="#sec-3-5-2">3.5.2 By indentation</a></li>
<li><a href="#sec-3-5-3">3.5.3 By Character</a></li>
</ul>
</li>
<li><a href="#sec-3-6">3.6 Inserting</a></li>
<li><a href="#sec-3-7">3.7 Killing</a></li>
<li><a href="#sec-3-8">3.8 Files</a>
<ul>
<li><a href="#sec-3-8-1">3.8.1 Opening</a></li>
<li><a href="#sec-3-8-2">3.8.2 Dired</a></li>
<li><a href="#sec-3-8-3">3.8.3 Deleting and Backups</a></li>
<li><a href="#sec-3-8-4">3.8.4 Scratch Files</a></li>
</ul>
</li>
<li><a href="#sec-3-9">3.9 As-you-type Checks</a>
<ul>
<li><a href="#sec-3-9-1">3.9.1 Flymake</a></li>
<li><a href="#sec-3-9-2">3.9.2 Flycheck</a></li>
</ul>
</li>
<li><a href="#sec-3-10">3.10 Undoing</a></li>
<li><a href="#sec-3-11">3.11 Emacs Lisp</a>
<ul>
<li><a href="#sec-3-11-1">3.11.1 Shortcuts</a></li>
<li><a href="#sec-3-11-2">3.11.2 Editing Parentheses</a></li>
<li><a href="#sec-3-11-3">3.11.3 Highlighting Parentheses</a></li>
<li><a href="#sec-3-11-4">3.11.4 Function Signatures</a></li>
<li><a href="#sec-3-11-5">3.11.5 On-the-fly Checking</a></li>
</ul>
</li>
<li><a href="#sec-3-12">3.12 Python</a></li>
<li><a href="#sec-3-13">3.13 CSS</a></li>
<li><a href="#sec-3-14">3.14 Less (CSS)</a></li>
<li><a href="#sec-3-15">3.15 Org-mode</a></li>
<li><a href="#sec-3-16">3.16 Performance</a></li>
<li><a href="#sec-3-17">3.17 Undocumented</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">


<p>
This is the Emacs environment I (Wilfred Hughes) use for development.
</p>

</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Licensing</h3>
<div class="outline-text-3" id="text-1-1">


<p>
Code I've written (init.el and files under `user-lisp/') is BSD
licensed, see COPYING.
</p>
</div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Reading This Document</h3>
<div class="outline-text-3" id="text-1-2">


<p>
This file is a literate programming document written with org-mode and
org-mode-babel. You can view init.html in a web browser, or read
init.org in Emacs.
</p>
<p>
init.el and init.html are generated files. To generate init.el, run
`M-x org-babel-tangle'. To generate init.html, run `M-x
org-export-as-html'.
</p>
<p>
By default, all the sections in this document are collapsed. You can
expand a header by pressing `&lt;TAB&gt;' when point is on that header. You
can expand all headers by pressing `C-u C-u C-u &lt;TAB&gt;'.
</p>
<p>
You can edit any code block by putting point inside the block and
pressing `C-c '' (press `C-c '' again to escape).
</p>
</div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Generating This Document</h3>
<div class="outline-text-3" id="text-1-3">


<p>
init.org is the source file that I edit, and init.el and init.html are
generated from it.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">org</span>)

(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">export-init-org</span> ()
  <span style="color: #888a85;">"Generate init.html and init.html from the current init.org file."</span>
  (interactive)
  (call-interactively 'org-export-as-html)
  (call-interactively 'org-babel-tangle))
</pre>




<p>
TODO: move this to the end of the generated init.el, so as not to slow
down the loading of styling.
</p>
</div>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Installing locally</h2>
<div class="outline-text-2" id="text-2">


<p>
This repository seeks to be as self-contained as possible. Generally,
you should be able to check out the repository and start using it on
any of Linux, OS X and Windows. To use this repository, you will
require:
</p>

</div>

<div id="outline-container-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> The Git Repository</h3>
<div class="outline-text-3" id="text-2-1">


<p>
Remove any existing .emacs.d configuration (or move elsewhere):
</p>



<pre class="src src-sh">rm -r ~/.emacs.d
</pre>


<p>
Clone the repo:
</p>



<pre class="src src-sh">git clone git://github.com/Wilfred/.emacs.d.git
</pre>


</div>

</div>

<div id="outline-container-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Emacs 24</h3>
<div class="outline-text-3" id="text-2-2">


<p>
I use this repository with Emacs 24. Most code works with Emacs 23 but
I don't test it often. Bug fixes for other Emacs versions (or other
Emacsen) are welcomed.
</p>
</div>

</div>

<div id="outline-container-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Python</h3>
<div class="outline-text-3" id="text-2-3">


<p>
I use pyflakes, which is available on PyPI. You can install it with:
</p>



<pre class="src src-sh">sudo pip install pyflakes
</pre>


</div>

</div>

<div id="outline-container-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> JavaScript</h3>
<div class="outline-text-3" id="text-2-4">


<p>
I use JSHint, which requires you to have node.js installed. To
install JSHint, run:
</p>



<pre class="src src-sh">sudo npm install -g jshint
</pre>


</div>

</div>

<div id="outline-container-2-5" class="outline-3">
<h3 id="sec-2-5"><span class="section-number-3">2.5</span> Less</h3>
<div class="outline-text-3" id="text-2-5">


<p>
I use lessc to check the syntax of `.less' files. You can install it
with:
</p>



<pre class="src src-sh">sudo npm install -g less
</pre>


</div>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Contents</h2>
<div class="outline-text-2" id="text-3">



</div>

<div id="outline-container-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Folder Structure</h3>
<div class="outline-text-3" id="text-3-1">


<p>
Code I've written lives in user-lisp. This includes packages that I
haven't polished enough to release yet, small convenience functions,
and package customisations.
</p>
<p>
Interactive commands, configuration and keybindings are kept in files
named `FOO-customisations.el'. Elisp convenience functions are kept in
files named `FOO-utils.el'.
</p>



<pre class="src src-emacs-lisp">(add-to-list 'load-path <span style="color: #ad7fa8; font-style: italic;">"~/.emacs.d/user-lisp/"</span>)
</pre>


<p>
Code that I haven't written lives in third-party-lisp. This directory
should ultimately disappear once all these packages live in MELPA.
</p>



<pre class="src src-emacs-lisp">(add-to-list 'load-path <span style="color: #ad7fa8; font-style: italic;">"~/.emacs.d/third-party-lisp/"</span>)
</pre>


</div>

</div>

<div id="outline-container-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Packages</h3>
<div class="outline-text-3" id="text-3-2">


<p>
I use ELPA packages heavily for functionality, primarily the MELPA
repository. We initalize all the packages here, so we can use them
later.
</p>



<pre class="src src-emacs-lisp"><span style="color: #888a85;">; </span><span style="color: #888a85;">marmalade is a third party repo that anyone can submit to, so has</span>
<span style="color: #888a85;">; </span><span style="color: #888a85;">many more packages</span>
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">package</span>)
(add-to-list 'package-archives '(<span style="color: #ad7fa8; font-style: italic;">"marmalade"</span> . <span style="color: #ad7fa8; font-style: italic;">"http://marmalade-repo.org/packages/"</span>))
(add-to-list 'package-archives '(<span style="color: #ad7fa8; font-style: italic;">"melpa"</span> . <span style="color: #ad7fa8; font-style: italic;">"http://melpa.milkbox.net/packages/"</span>) t)

(package-initialize)
</pre>


<p>
When a package is installed, it's byte-compiled. However, git is set
up to ignore .elc files (see the .gitignore file). The system that
installs the file therefore has .elc files, but other systems need to
byte-compile those directories.
</p>
<p>
To make matters worse, we can't just compile on startup any package
files that aren't compiled already, since some files fail compilation
every time. Instead, we compile directories that don't contain any
.elc files.
</p>



<pre class="src src-emacs-lisp"><span style="color: #888a85;">;; </span><span style="color: #888a85;">load the packages we've installed on another system but pulled in with git, so they aren't compiled</span>
(<span style="color: #729fcf; font-weight: bold;">eval-when-compile</span> '(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">cl</span>))
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">dash</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">s</span>)

(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">was-compiled-p</span> (path)
  <span style="color: #888a85;">"Does the directory at PATH contain any .elc files?"</span>
  (<span style="color: #729fcf; font-weight: bold;">--any-p</span> (s-ends-with-p <span style="color: #ad7fa8; font-style: italic;">".elc"</span> <span style="color: #ff6347;">it</span>) (directory-files path)))

(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">no-dot-directories</span> (directories)
  <span style="color: #888a85;">"Exclude the . and .. directory from a list."</span>
  (<span style="color: #729fcf; font-weight: bold;">--remove</span> (or (string= <span style="color: #ad7fa8; font-style: italic;">"."</span> (file-name-nondirectory <span style="color: #ff6347;">it</span>))
                (string= <span style="color: #ad7fa8; font-style: italic;">".."</span> (file-name-nondirectory <span style="color: #ff6347;">it</span>)))
            directories))

(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">ensure-packages-compiled</span> ()
  <span style="color: #888a85;">"If any packages installed with package.el aren't compiled yet, compile them."</span>
  (<span style="color: #729fcf; font-weight: bold;">let*</span> ((package-files (no-dot-directories (directory-files package-user-dir t)))
         (package-directories (<span style="color: #729fcf; font-weight: bold;">-filter</span> 'file-directory-p package-files)))
    (<span style="color: #729fcf; font-weight: bold;">dolist</span> (directory package-directories)
      (<span style="color: #729fcf; font-weight: bold;">unless</span> (was-compiled-p directory)
        (byte-recompile-directory directory 0)))))

(ensure-packages-compiled)

<span style="color: #888a85;">;; </span><span style="color: #888a85;">todo: clean up orphaned .elc files</span>
</pre>


</div>

</div>

<div id="outline-container-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Paths</h3>
<div class="outline-text-3" id="text-3-3">


<p>
We set up Emacs' exec-path based on PATH in a shell. This is primarily
for OS X, where starting Emacs in GUI mode doesn't inherit the shell's
environment. This ensures that any command we can call from a shell,
we can call inside Emacs.
</p>
<p>
Note this function comes from the package `exec-path-from-shell.el'.
</p>



<pre class="src src-emacs-lisp"><span style="color: #888a85;">;; </span><span style="color: #888a85;">set exec-path according to the system's PATH</span>
(exec-path-from-shell-initialize)

</pre>


</div>

</div>

<div id="outline-container-3-4" class="outline-3">
<h3 id="sec-3-4"><span class="section-number-3">3.4</span> UI</h3>
<div class="outline-text-3" id="text-3-4">



</div>

<div id="outline-container-3-4-1" class="outline-4">
<h4 id="sec-3-4-1"><span class="section-number-4">3.4.1</span> Theme</h4>
<div class="outline-text-4" id="text-3-4-1">


<p>
I like the tangotango theme, which depends on color-theme. In Emacs
24, this isn't necessary (todo: update this).
</p>



<pre class="src src-emacs-lisp">(add-to-list 'load-path <span style="color: #ad7fa8; font-style: italic;">"~/.emacs.d/third-party-lisp/color-theme"</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">color-theme</span>)

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">color-theme-tangotango</span>)
<span style="color: #888a85;">;; </span><span style="color: #888a85;">load theme when we are started with $ emacsclient -c</span>
(add-hook 'after-make-frame-functions
          '(<span style="color: #729fcf; font-weight: bold;">lambda</span> (f)
             (<span style="color: #729fcf; font-weight: bold;">with-selected-frame</span> f
               (<span style="color: #729fcf; font-weight: bold;">when</span> (window-system f)
                 (color-theme-tangotango)))))
<span style="color: #888a85;">;; </span><span style="color: #888a85;">load theme when we are started with $ emacs</span>
(<span style="color: #729fcf; font-weight: bold;">when</span> window-system
  (color-theme-tangotango))

</pre>


</div>

</div>

<div id="outline-container-3-4-2" class="outline-4">
<h4 id="sec-3-4-2"><span class="section-number-4">3.4.2</span> Hiding and Showing</h4>
<div class="outline-text-4" id="text-3-4-2">





<pre class="src src-emacs-lisp"><span style="color: #888a85;">;; </span><span style="color: #888a85;">hide toolbar and scrollbar</span>
(tool-bar-mode 0)
(scroll-bar-mode 0)

<span style="color: #888a85;">;; </span><span style="color: #888a85;">show x-position (ie column number) for point in buffer</span>
(column-number-mode 1)
</pre>


</div>

</div>

<div id="outline-container-3-4-3" class="outline-4">
<h4 id="sec-3-4-3"><span class="section-number-4">3.4.3</span> Recursive Editing</h4>
<div class="outline-text-4" id="text-3-4-3">


<p>
We can make the minibuffer much more useful by enabling recursive
usage. This means that when the minibuffer is active we can still call
commands that require the minibuffer.
</p>



<pre class="src src-emacs-lisp">(setq enable-recursive-minibuffers t)
</pre>


<p>    
It's easy to lose track of whether we're in a recursive minibuffer or
not. We display the recursion level in the minibuffer to avoid confusion.
</p>



<pre class="src src-emacs-lisp">(minibuffer-depth-indicate-mode 1)
</pre>


</div>
</div>

</div>

<div id="outline-container-3-5" class="outline-3">
<h3 id="sec-3-5"><span class="section-number-3">3.5</span> Moving Around</h3>
<div class="outline-text-3" id="text-3-5">



</div>

<div id="outline-container-3-5-1" class="outline-4">
<h4 id="sec-3-5-1"><span class="section-number-4">3.5.1</span> By Symbol</h4>
<div class="outline-text-4" id="text-3-5-1">


<p>
It's extremely useful to be able to move between different occurrences
of the same symbol.
</p>



<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"M-n"</span>) 'highlight-symbol-next)
(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"M-p"</span>) 'highlight-symbol-prev)
</pre>


<p>
Jumping to the first occurrence of the symbol is handy for finding
where a symbol was imported.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">highlight-symbol-first</span> ()
  <span style="color: #888a85;">"Jump to the first location of symbol at point."</span>
  (interactive)
  (push-mark)
  (eval
   `(<span style="color: #729fcf; font-weight: bold;">progn</span>
      (goto-char (point-min))
      (search-forward-regexp
       (rx symbol-start ,(thing-at-point 'symbol) symbol-end)
       nil t)
      (beginning-of-thing 'symbol))))

(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"M-P"</span>) 'highlight-symbol-first)
</pre>


</div>

</div>

<div id="outline-container-3-5-2" class="outline-4">
<h4 id="sec-3-5-2"><span class="section-number-4">3.5.2</span> By indentation</h4>
<div class="outline-text-4" id="text-3-5-2">


<p>
`C-a' normally moves us to the beginning of the line
unconditionally. This version is more useful, as it moves to the
first non-whitespace character if we're already at the beginning of
the line. Repeated use of `C-a' toggles between these two positions.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">beginning-of-line-dwim</span> ()
  <span style="color: #888a85;">"Toggles between moving point to the first non-whitespace character, and</span>
<span style="color: #888a85;">the start of the line."</span>
  (interactive)
  (<span style="color: #729fcf; font-weight: bold;">let</span> ((start-position (point)))
    <span style="color: #888a85;">;; </span><span style="color: #888a85;">see if going to the beginning of the line changes our position</span>
    (move-beginning-of-line nil)

    (<span style="color: #729fcf; font-weight: bold;">when</span> (= (point) start-position)
        <span style="color: #888a85;">;; </span><span style="color: #888a85;">we're already at the beginning of the line, so go to the</span>
        <span style="color: #888a85;">;; </span><span style="color: #888a85;">first non-whitespace character</span>
        (back-to-indentation))))

(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"C-a"</span>) 'beginning-of-line-dwim)
</pre>


</div>

</div>

<div id="outline-container-3-5-3" class="outline-4">
<h4 id="sec-3-5-3"><span class="section-number-4">3.5.3</span> By Character</h4>
<div class="outline-text-4" id="text-3-5-3">


<p>
Vim has a handy command where you can type `f' to jump to the next
occurrence of a character on a line.
</p>
<p>
We can do this with `jump-char' without the constraint that the
character must be on the current line. This command needs to be
accessible with a short shortcut, so we use `M-m'. `M-m' is bound to
`back-to-indentation' by default, but our `C-a' behaviour makes it
redundant.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">jump-char</span>)

(global-set-key [(meta m)] 'jump-char-forward)
(global-set-key [(shift meta m)] 'jump-char-backward)

</pre>


</div>
</div>

</div>

<div id="outline-container-3-6" class="outline-3">
<h3 id="sec-3-6"><span class="section-number-3">3.6</span> Inserting</h3>
<div class="outline-text-3" id="text-3-6">


<p>
It's often useful to start a new line of code that's above or below
the current line. This code is taken from
<a href="http://emacsredux.com/blog/2013/03/26/smarter-open-line/">http://emacsredux.com/blog/2013/03/26/smarter-open-line/</a> .
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">smart-open-line</span> ()
  <span style="color: #888a85;">"Insert an empty line after the current line.</span>
<span style="color: #888a85;">Position the cursor at its beginning, according to the current mode."</span>
  (interactive)
  (move-end-of-line nil)
  (newline-and-indent))

(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"M-o"</span>) 'smart-open-line)

(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">smart-open-line-above</span> ()
  <span style="color: #888a85;">"Insert an empty line above the current line.</span>
<span style="color: #888a85;">Position the cursor at it's beginning, according to the current mode."</span>
  (interactive)
  (move-beginning-of-line nil)
  (newline-and-indent)
  (forward-line -1)
  (indent-according-to-mode))

(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"M-O"</span>) 'smart-open-line-above)
</pre>


</div>

</div>

<div id="outline-container-3-7" class="outline-3">
<h3 id="sec-3-7"><span class="section-number-3">3.7</span> Killing</h3>
<div class="outline-text-3" id="text-3-7">


<p>
It's handy to also delete the trailing newline when using `C-k'.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">defadvice</span> <span style="color: #edd400; font-weight: bold;">kill-line</span> (around kill-line-remove-newline activate)
  (<span style="color: #729fcf; font-weight: bold;">let</span> ((kill-whole-line t))
    ad-do-it))
</pre>


<p>
I sometimes want to simply delete a region, rather than
saving it to the kill-ring. I've added a function that allows me to
type `C-u C-w' to delete the region, whilst `C-w' works as normal.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">kill-or-delete-region</span> (beg end prefix)
  <span style="color: #888a85;">"Delete the region, storing it in the kill-ring.</span>
<span style="color: #888a85;">If a prefix argument is given, don't change the kill-ring."</span>
  (interactive <span style="color: #ad7fa8; font-style: italic;">"r\nP"</span>)
  (<span style="color: #729fcf; font-weight: bold;">if</span> prefix
      (delete-region beg end)
    (kill-region beg end)))

(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"C-w"</span>) 'kill-or-delete-region)

</pre>


</div>

</div>

<div id="outline-container-3-8" class="outline-3">
<h3 id="sec-3-8"><span class="section-number-3">3.8</span> Files</h3>
<div class="outline-text-3" id="text-3-8">



</div>

<div id="outline-container-3-8-1" class="outline-4">
<h4 id="sec-3-8-1"><span class="section-number-4">3.8.1</span> Opening</h4>
<div class="outline-text-4" id="text-3-8-1">


<p>
It's useful to be able to quickly open files that we opened before. We
define a function for this:
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">recentf</span>)

<span style="color: #888a85;">;; </span><span style="color: #888a85;">offer recently accessed files from the menu</span>
(recentf-mode t)

<span style="color: #888a85;">;; </span><span style="color: #888a85;">remember this many files</span>
(setq recentf-max-saved-items 200)

(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">ido-recentf-open</span> ()
  <span style="color: #888a85;">"Use `</span><span style="color: #8ae234;">ido-completing-read</span><span style="color: #888a85;">' to \\[</span><span style="color: #8ae234;">find-file</span><span style="color: #888a85;">] a recent file"</span>
  (interactive)
  (<span style="color: #729fcf; font-weight: bold;">if</span> (find-file (ido-completing-read <span style="color: #ad7fa8; font-style: italic;">"Find recent file: "</span> recentf-list))
      (message <span style="color: #ad7fa8; font-style: italic;">"Opening file..."</span>)
    (message <span style="color: #ad7fa8; font-style: italic;">"Aborting"</span>)))
</pre>


<p>
We bind this to `C-x C-r' (mnemonic: recent). By default, `C-x C-r' is bound to
`find-file-read-only', which isn't very useful. (You can set any file
as read only with `read-only-mode', mapped to `C-x C-q'.)
</p>



<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"C-x C-r"</span>) 'ido-recentf-open)
</pre>


<p>
Most of the time though, it's helpful to be able to pick a file in the
same source code repository as the current buffer. There are several
tools to do this. The best I've found is `find-file-in-repository'.
</p>
<p>
`find-file-in-repository' uses command line commands to find out the
contents of your repository. For example, for git, it uses `git
ls-files` (see <i>&lt;elisp:ffir-repository&gt;</i> types for the full list). This
makes it very fast, and ensures that files ignored by git are ignored.
</p>
<p>
Alternatives worth mentioning are `projectile' and
`find-file-in-project'. `projectile' seems to have the most users, but
I've found it to be a little bit slower, even with external
commands. `find-file-in-project' seems unmaintained.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">find-file-in-repository</span>)
</pre>


<p>
Ido can become very slow with large lists. This is largely due to
flexible matching, used when there isn't an exact substring match. We
switch off flexible matching with `find-file-in-repository'.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">defadvice</span> <span style="color: #edd400; font-weight: bold;">find-file-in-repository</span> (around disable-ido-flex-matching activate)
  (<span style="color: #729fcf; font-weight: bold;">let</span> ((ido-enable-flex-matching nil)
        (ido-case-fold t))
    ad-do-it))
</pre>


<p>
We bind `find-file-in-repository' to `C-x C-g', as we use it
a lot and it's right next to `C-x C-f'.
</p>



<pre class="src src-emacs-lisp">(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"C-x C-g"</span>) 'find-file-in-repository)
</pre>


<p>
Finally, it's useful to reopen the same buffers when Emacs is
restarted:
</p>



<pre class="src src-emacs-lisp">(desktop-save-mode 1)
</pre>


</div>

</div>

<div id="outline-container-3-8-2" class="outline-4">
<h4 id="sec-3-8-2"><span class="section-number-4">3.8.2</span> Dired</h4>
<div class="outline-text-4" id="text-3-8-2">


<p>
Dired isn't very colourful by default, but `dired+' has helpful
highlighting.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">dired+</span>)
</pre>


</div>

</div>

<div id="outline-container-3-8-3" class="outline-4">
<h4 id="sec-3-8-3"><span class="section-number-4">3.8.3</span> Deleting and Backups</h4>
<div class="outline-text-4" id="text-3-8-3">


<p>
When we delete a file, it should go to the recycle bin rather than
just acting like <i>&lt;shell:rm&gt;</i>.
</p>



<pre class="src src-emacs-lisp">(setq delete-by-moving-to-trash t)
</pre>


<p>
Emacs' backup behaviour is helpful, so we increase the number of
backups. However, rather than writing foo~1~ files everywhere, we
store all our backups in `~/.saves`.
</p>



<pre class="src src-emacs-lisp">(setq
   backup-by-copying t      <span style="color: #888a85;">; </span><span style="color: #888a85;">don't clobber symlinks</span>
   backup-directory-alist
    '((<span style="color: #ad7fa8; font-style: italic;">"."</span> . <span style="color: #ad7fa8; font-style: italic;">"~/.saves"</span>))    <span style="color: #888a85;">; </span><span style="color: #888a85;">don't litter my fs tree</span>
   delete-old-versions t
   kept-new-versions 6
   kept-old-versions 2
   version-control t)       <span style="color: #888a85;">; </span><span style="color: #888a85;">use versioned backups</span>
</pre>


<p>
However, Emacs isn't aggressive enough with backups. We use
backup-each-save to ensure we have a copy of state of every file we've
modified.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">backup-each-save</span>)
(add-hook 'after-save-hook 'backup-each-save)
</pre>


</div>

</div>

<div id="outline-container-3-8-4" class="outline-4">
<h4 id="sec-3-8-4"><span class="section-number-4">3.8.4</span> Scratch Files</h4>
<div class="outline-text-4" id="text-3-8-4">


<p>
It's often useful to create a throwaway file to write a minimal
testcase for some language or library feature.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">start-scratch-file</span> (file-name)
  <span style="color: #888a85;">"Create a file in ~/scratch for the given file name."</span>
  (interactive <span style="color: #ad7fa8; font-style: italic;">"sName of scratch file: "</span>)
  (<span style="color: #729fcf; font-weight: bold;">let</span> ((path (expand-file-name (format <span style="color: #ad7fa8; font-style: italic;">"~/scratch/%s"</span> file-name))))
    <span style="color: #888a85;">;; </span><span style="color: #888a85;">create directories as necessary</span>
    (<span style="color: #729fcf; font-weight: bold;">when</span> (s-contains-p <span style="color: #ad7fa8; font-style: italic;">"/"</span> file-name)
      (make-directory (file-name-directory path) t))
    (find-file path)))
</pre>


<p>
It's also useful to quickly generate a minimal HTML page to play with.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">start-scratch-html-file</span> (file-name)
  <span style="color: #888a85;">"Create a test HTML file in ~/scratch to play around with."</span>
  (interactive <span style="color: #ad7fa8; font-style: italic;">"sName of scratch HTML file: "</span>)
  (start-scratch-file file-name)
  (erase-buffer)
  (insert <span style="color: #ad7fa8; font-style: italic;">"&lt;!DOCTYPE html&gt;</span>
<span style="color: #ad7fa8; font-style: italic;">&lt;html&gt;</span>
<span style="color: #ad7fa8; font-style: italic;">    &lt;head&gt;</span>
<span style="color: #ad7fa8; font-style: italic;">        &lt;title&gt;</span>
<span style="color: #ad7fa8; font-style: italic;">        &lt;/title&gt;</span>
<span style="color: #ad7fa8; font-style: italic;">        &lt;style type=\"text/css\"&gt;</span>
<span style="color: #ad7fa8; font-style: italic;">        &lt;/style&gt;</span>
<span style="color: #ad7fa8; font-style: italic;">    &lt;/head&gt;</span>
<span style="color: #ad7fa8; font-style: italic;">    &lt;body&gt;</span>

<span style="color: #ad7fa8; font-style: italic;">    &lt;/body&gt;</span>
<span style="color: #ad7fa8; font-style: italic;">&lt;/html&gt;"</span>)
  (forward-line -2)
  (move-end-of-line nil))
</pre>


</div>
</div>

</div>

<div id="outline-container-3-9" class="outline-3">
<h3 id="sec-3-9"><span class="section-number-3">3.9</span> As-you-type Checks</h3>
<div class="outline-text-3" id="text-3-9">



</div>

<div id="outline-container-3-9-1" class="outline-4">
<h4 id="sec-3-9-1"><span class="section-number-4">3.9.1</span> Flymake</h4>
<div class="outline-text-4" id="text-3-9-1">


<p>
(Note that there's language-specific flymake configuration too.)
</p>
<p>
It's really useful to be able to move between flymake errors, so we
bind F8 and F9 for this. Since there's a gap between these two keys,
they're easy to find.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">flymake</span>)
(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"&lt;f8&gt;"</span>) 'flymake-goto-prev-error)
(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"&lt;f9&gt;"</span>) 'flymake-goto-next-error)
</pre>


<p>
When the cursor (point) is on a line, we want to show the error on
that line in the minibuffer.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">flymake-error-at-point</span> ()
  <span style="color: #888a85;">"Show the flymake error in the minibuffer when point is on an invalid line."</span>
  (<span style="color: #729fcf; font-weight: bold;">when</span> (get-char-property (point) 'flymake-overlay)
    (<span style="color: #729fcf; font-weight: bold;">let</span> ((help (get-char-property (point) 'help-echo)))
      (<span style="color: #729fcf; font-weight: bold;">if</span> help (message <span style="color: #ad7fa8; font-style: italic;">"%s"</span> help)))))

(add-hook 'post-command-hook 'flymake-error-at-point)
</pre>


<p>
I prefer my errors underlined.
</p>



<pre class="src src-emacs-lisp">(custom-set-faces
 '(flymake-errline ((((class color)) (<span style="color: #729fcf;">:underline</span> <span style="color: #ad7fa8; font-style: italic;">"Red"</span>))))
 '(flymake-warnline ((((class color)) (<span style="color: #729fcf;">:underline</span> <span style="color: #ad7fa8; font-style: italic;">"Orange"</span>)))))
</pre>


</div>

</div>

<div id="outline-container-3-9-2" class="outline-4">
<h4 id="sec-3-9-2"><span class="section-number-4">3.9.2</span> Flycheck</h4>
<div class="outline-text-4" id="text-3-9-2">


<p>
Flycheck is an excellent on-the-fly checker that provides many
additional features and languages. Flymake is part of stock Emacs,
flychcks is third-party.
</p>
<p>
Flycheck can be quite slow with a large number of errors. We reduce
how often we run it. We also change the highlighting to simply
highlight the whole line, as it's much faster. See
<a href="https://github.com/lunaryorn/flycheck/issues/153#issuecomment-19450255">https://github.com/lunaryorn/flycheck/issues/153#issuecomment-19450255</a>
</p>



<pre class="src src-emacs-lisp">(setq flycheck-highlighting-mode 'lines)
</pre>


<p>
Style flycheck errors consistently with flymake.
</p>



<pre class="src src-emacs-lisp">(custom-set-faces
 '(flycheck-error ((((class color)) (<span style="color: #729fcf;">:underline</span> <span style="color: #ad7fa8; font-style: italic;">"Red"</span>))))
 '(flycheck-warning ((((class color)) (<span style="color: #729fcf;">:underline</span> <span style="color: #ad7fa8; font-style: italic;">"Orange"</span>)))))
</pre>


<p>
We use the same movement keys for flycheck as we do for flymake.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">flycheck</span>)
(define-key flycheck-mode-map (kbd <span style="color: #ad7fa8; font-style: italic;">"&lt;f8&gt;"</span>) 'flycheck-previous-error)
(define-key flycheck-mode-map (kbd <span style="color: #ad7fa8; font-style: italic;">"&lt;f9&gt;"</span>) 'flycheck-next-error)
</pre>


</div>
</div>

</div>

<div id="outline-container-3-10" class="outline-3">
<h3 id="sec-3-10"><span class="section-number-3">3.10</span> Undoing</h3>
<div class="outline-text-3" id="text-3-10">


<p>
Emacs' undo facility is excellent, but undo-tree is even better.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">undo-tree</span>)
(global-undo-tree-mode)
</pre>


</div>

</div>

<div id="outline-container-3-11" class="outline-3">
<h3 id="sec-3-11"><span class="section-number-3">3.11</span> Emacs Lisp</h3>
<div class="outline-text-3" id="text-3-11">



</div>

<div id="outline-container-3-11-1" class="outline-4">
<h4 id="sec-3-11-1"><span class="section-number-4">3.11.1</span> Shortcuts</h4>
<div class="outline-text-4" id="text-3-11-1">


<p>
eval-defun is bound to `C-M-x', but Gnome doesn't allow Emacs to
receive that key sequence. It's very useful command when developing,
especially since giving a prefix argument switches on edebug for that
function.
</p>



<pre class="src src-emacs-lisp">(define-key emacs-lisp-mode-map (kbd <span style="color: #ad7fa8; font-style: italic;">"C-c e"</span>) 'eval-defun)
</pre>


<p>
Similarly, toggle-debug-on-error is something I call a lot when
developing, and it doesn't have have any keybinding.
</p>



<pre class="src src-emacs-lisp">(define-key emacs-lisp-mode-map (kbd <span style="color: #ad7fa8; font-style: italic;">"C-c d"</span>) 'toggle-debug-on-error)
</pre>


<p>
When writing and debugging macros, it's really important to be able
to see what they expand to. Macrostep allows us to incrementally
expand the macros in our elisp file.
</p>



<pre class="src src-emacs-lisp">(define-key emacs-lisp-mode-map (kbd <span style="color: #ad7fa8; font-style: italic;">"C-c m"</span>) 'macrostep-expand)
</pre>


</div>

</div>

<div id="outline-container-3-11-2" class="outline-4">
<h4 id="sec-3-11-2"><span class="section-number-4">3.11.2</span> Editing Parentheses</h4>
<div class="outline-text-4" id="text-3-11-2">


<p>
Paredit make editing code with parentheses wonderful and has been the
gold standard for lisp coding for some time. Smartparens has recently
gained popularity as an paredit alternative, but I haven't invested
the time to learn it yet.
</p>



<pre class="src src-emacs-lisp">(add-hook 'emacs-lisp-mode-hook
          (<span style="color: #729fcf; font-weight: bold;">lambda</span> () (paredit-mode 1)))
</pre>


</div>

</div>

<div id="outline-container-3-11-3" class="outline-4">
<h4 id="sec-3-11-3"><span class="section-number-4">3.11.3</span> Highlighting Parentheses</h4>
<div class="outline-text-4" id="text-3-11-3">


<p>
We colour each pair of parentheses according to their depth. This is
useful for seeing similarly nested lines, such as conditions in a
cond expression.
</p>



<pre class="src src-emacs-lisp">(add-hook 'emacs-lisp-mode-hook 'rainbow-delimiters-mode)
</pre>


<p>
Our theme (tangotango) only provides colours for the first few nesting
levels before repeating. We override the face colours so we have
unique colours until we're seven levels deep.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">rainbow-delimiters</span>)
(set-face-foreground 'rainbow-delimiters-depth-1-face <span style="color: #ad7fa8; font-style: italic;">"white"</span>)
(set-face-foreground 'rainbow-delimiters-depth-2-face <span style="color: #ad7fa8; font-style: italic;">"cyan"</span>)
(set-face-foreground 'rainbow-delimiters-depth-3-face <span style="color: #ad7fa8; font-style: italic;">"yellow"</span>)
(set-face-foreground 'rainbow-delimiters-depth-4-face <span style="color: #ad7fa8; font-style: italic;">"green"</span>)
(set-face-foreground 'rainbow-delimiters-depth-5-face <span style="color: #ad7fa8; font-style: italic;">"orange"</span>)
(set-face-foreground 'rainbow-delimiters-depth-6-face <span style="color: #ad7fa8; font-style: italic;">"purple"</span>)
(set-face-foreground 'rainbow-delimiters-depth-7-face <span style="color: #ad7fa8; font-style: italic;">"white"</span>)
(set-face-foreground 'rainbow-delimiters-depth-8-face <span style="color: #ad7fa8; font-style: italic;">"cyan"</span>)
(set-face-foreground 'rainbow-delimiters-depth-9-face <span style="color: #ad7fa8; font-style: italic;">"yellow"</span>)
(set-face-foreground 'rainbow-delimiters-unmatched-face <span style="color: #ad7fa8; font-style: italic;">"red"</span>)
</pre>


</div>

</div>

<div id="outline-container-3-11-4" class="outline-4">
<h4 id="sec-3-11-4"><span class="section-number-4">3.11.4</span> Function Signatures</h4>
<div class="outline-text-4" id="text-3-11-4">


<p>
We use eldoc to show the signature of the function at point in the
minibuffer.
</p>



<pre class="src src-emacs-lisp">(add-hook 'emacs-lisp-mode-hook 'eldoc-mode)
</pre>


</div>

</div>

<div id="outline-container-3-11-5" class="outline-4">
<h4 id="sec-3-11-5"><span class="section-number-4">3.11.5</span> On-the-fly Checking</h4>
<div class="outline-text-4" id="text-3-11-5">


<p>
It's really useful to use flycheck when coding elisp. It detects
mistyped variables, deprecated functions (everything that
byte-compilation checks).
</p>



<pre class="src src-emacs-lisp">(add-hook 'emacs-lisp-mode-hook 'flycheck-mode)
</pre>


<p>
Flycheck is able to initialise installed packages before checking
elisp (useful when requiring third party libraries). It does not do
this by default, to encourage developers to use Cask instead (see
<a href="https://github.com/flycheck/flycheck/pull/176">https://github.com/flycheck/flycheck/pull/176</a>). We switch this
behaviour back on.
</p>



<pre class="src src-emacs-lisp">(setq-default flycheck-emacs-lisp-initialize-packages t)
</pre>


<p>
By default, flycheck also runs checkdoc on elisp code. This gets in
the way for quick throwaway elisp scripts, so we switch off checkdoc.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">flycheck</span>)
(setq flycheck-checkers (<span style="color: #729fcf; font-weight: bold;">--remove</span> (eq <span style="color: #ff6347;">it</span> 'emacs-lisp-checkdoc) flycheck-checkers))
</pre>


</div>
</div>

</div>

<div id="outline-container-3-12" class="outline-3">
<h3 id="sec-3-12"><span class="section-number-3">3.12</span> Python</h3>
<div class="outline-text-3" id="text-3-12">


<p>
Having brackets and quotation marks closed is very useful in
Python. Paredit isn't well suited for Python, and `electric-pair-mode`
isn't very smart. Autopair works well, but performance is poor on
medium size (a few hundred LOC) files with many strings. Smartparens
is the best solution.
</p>



<pre class="src src-emacs-lisp">(add-hook 'python-mode-hook 'smartparens-mode)
</pre>


<p>
We use pyflakes with flymake to check for coding errors.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">flymake-python-pyflakes</span>)
(add-hook 'python-mode-hook 'flymake-python-pyflakes-load)
</pre>


<p>
I like to write docstrings with example usage. These examples aren't
always valid doctests, so we switch off doctest checks.
</p>



<pre class="src src-emacs-lisp">(setenv <span style="color: #ad7fa8; font-style: italic;">"PYFLAKES_NODOCTEST"</span> <span style="color: #ad7fa8; font-style: italic;">"y"</span>)
</pre>


<p>
I often write triple-quoted docstrings, so it's convenient to have a
shortcut for inserting them.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">python</span>)

(<span style="color: #729fcf; font-weight: bold;">define-skeleton</span> <span style="color: #edd400; font-weight: bold;">python-insert-docstring</span>
  <span style="color: #888a85;">"Insert a Python docstring."</span>
  <span style="color: #ad7fa8; font-style: italic;">"This string is ignored!"</span>
  <span style="color: #ad7fa8; font-style: italic;">"\"\"\""</span> - <span style="color: #ad7fa8; font-style: italic;">"\"\"\""</span>)

(define-key python-mode-map (kbd <span style="color: #ad7fa8; font-style: italic;">"C-c s"</span>) 'python-insert-docstring)
</pre>


</div>

</div>

<div id="outline-container-3-13" class="outline-3">
<h3 id="sec-3-13"><span class="section-number-3">3.13</span> CSS</h3>
<div class="outline-text-3" id="text-3-13">


<p>
Currently I'm working on projects that require tabs for CSS
indentation.
</p>



<pre class="src src-emacs-lisp">(add-hook 'css-mode-hook
          (function
           (<span style="color: #729fcf; font-weight: bold;">lambda</span> ()
             (<span style="color: #729fcf; font-weight: bold;">progn</span>
               (setq css-indent-offset 4)
               (setq indent-tabs-mode nil)))))
</pre>


<p>   
It's really handy to highlight CSS colour values to show the colour
they represent.
</p>



<pre class="src src-emacs-lisp">(add-hook 'css-mode-hook 'rainbow-mode)
</pre>


</div>

</div>

<div id="outline-container-3-14" class="outline-3">
<h3 id="sec-3-14"><span class="section-number-3">3.14</span> Less (CSS)</h3>
<div class="outline-text-3" id="text-3-14">


<p>
The less compiler doesn't give much feedback, but it does gives us a
syntax check.
</p>



<pre class="src src-emacs-lisp">(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">less-css-mode</span>)
(add-hook 'less-css-mode-hook 'flymake-mode)
</pre>


</div>

</div>

<div id="outline-container-3-15" class="outline-3">
<h3 id="sec-3-15"><span class="section-number-3">3.15</span> Org-mode</h3>
<div class="outline-text-3" id="text-3-15">


<p>
We often use code snippets in org-mode files, so syntax highlight
them.
</p>



<pre class="src src-emacs-lisp">(setq org-src-fontify-natively t)
</pre>


</div>

</div>

<div id="outline-container-3-16" class="outline-3">
<h3 id="sec-3-16"><span class="section-number-3">3.16</span> Performance</h3>
<div class="outline-text-3" id="text-3-16">


<p>
Emacs will run garbage collection after `gc-cons-threshold' bytes of
consing. The default value is 800,000 bytes, or ~ 0.7 MiB. By
increasing to 10 MiB we reduce the number of pauses due to garbage collection.
</p>



<pre class="src src-emacs-lisp">(setq gc-cons-threshold (* 10 1024 1024))
</pre>



</div>

</div>

<div id="outline-container-3-17" class="outline-3">
<h3 id="sec-3-17"><span class="section-number-3">3.17</span> Undocumented</h3>
<div class="outline-text-3" id="text-3-17">





<pre class="src src-emacs-lisp"><span style="color: #888a85;">; </span><span style="color: #888a85;">always close the minibuffer on C-x o:</span>
<span style="color: #888a85;">; </span><span style="color: #888a85;">&lt;jlf&gt; wilfredh: you could before-advise other-window to quit first</span>
<span style="color: #888a85;">; </span><span style="color: #888a85;">if the minibuffer is active.. but it would be better to break that</span>
<span style="color: #888a85;">; </span><span style="color: #888a85;">habit :)</span>

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">ui-customisations</span>)

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">file-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">editing-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">kill-ring-customisations</span>)

(<span style="color: #729fcf; font-weight: bold;">if</span> (eq system-type 'darwin)
    (<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">os-x-fixes</span>))

<span style="color: #888a85;">; </span><span style="color: #888a85;">TODO: increase kill ring size</span>

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">ido-customisations</span>)

<span style="color: #888a85;">;; </span><span style="color: #888a85;">make re-builder use the same regexp format as regexp-replace (no double escaping)</span>
(setq reb-re-syntax 'string)

<span style="color: #888a85;">;; </span><span style="color: #888a85;">treat space charcters as matching space characters, not like PCRE's '\s+'</span>
(setq search-whitespace-regexp nil)

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">completion-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">structured-text-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">isearch-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">html-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">python-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">javascript-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">xml-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">lisp-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">haskell-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">c-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">sh-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">coffee-customisations</span>)

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">startup-customisations</span>)

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">editd-customisations</span>)

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">git-customisations</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">git-flow-release</span>)

<span style="color: #888a85;">;; </span><span style="color: #888a85;">stolen from http://demonastery.org/2013/04/emacs-narrow-to-region-indirect/</span>
(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">narrow-to-region-indirect</span> (start end)
  <span style="color: #888a85;">"Restrict editing in this buffer to the current region, indirectly."</span>
  (interactive <span style="color: #ad7fa8; font-style: italic;">"r"</span>)
  (<span style="color: #729fcf; font-weight: bold;">let</span> ((buf (clone-indirect-buffer nil nil)))
    (<span style="color: #729fcf; font-weight: bold;">with-current-buffer</span> buf
      (narrow-to-region start end))
    (switch-to-buffer buf)))

(setq ag-highlight-search 't)
(global-set-key (kbd <span style="color: #ad7fa8; font-style: italic;">"&lt;f5&gt;"</span>) 'ag-project-at-point)

<span style="color: #888a85;">;; </span><span style="color: #888a85;">stolen from http://whattheemacsd.com/setup-dired.el-02.html</span>
(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">dired-back-to-top</span> ()
  (interactive)
  (beginning-of-buffer)
  (dired-next-line (<span style="color: #729fcf; font-weight: bold;">if</span> dired-omit-mode 2 4)))

(define-key dired-mode-map
  (vector 'remap 'beginning-of-buffer) 'dired-back-to-top)

(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">dired-jump-to-bottom</span> ()
  (interactive)
  (end-of-buffer)
  (dired-next-line -1))

(define-key dired-mode-map
  (vector 'remap 'end-of-buffer) 'dired-jump-to-bottom)

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">conflicts</span>)

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">tags-utils</span>)

<span style="color: #888a85;">;; </span><span style="color: #888a85;">crontab mode for files named</span>
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">crontab-mode</span>)
(add-to-list 'auto-mode-alist '(<span style="color: #ad7fa8; font-style: italic;">"crontab.*?\\'"</span> . crontab-mode))

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">wiki</span>)
(setq major-mode 'text-mode)
(setq wiki-directories (list (expand-file-name <span style="color: #ad7fa8; font-style: italic;">"~/Dropbox/Wiki/"</span>)))

(setq ring-bell-function 'ignore)

<span style="color: #888a85;">; </span><span style="color: #888a85;">suspend seems to crash on Gnome 3, and I don't use it anyway, so just disable it</span>
(setq cannot-suspend t)
(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">suspend-emacs</span> (<span style="color: #8ae234; font-weight: bold;">&amp;rest</span>)
  (interactive))
(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">suspend-frame</span> (<span style="color: #8ae234; font-weight: bold;">&amp;rest</span>)
  (interactive))

<span style="color: #888a85;">;; </span><span style="color: #888a85;">windmove allows S-&lt;right&gt; and S-&lt;right&gt; to switch between windows</span>
<span style="color: #888a85;">;; </span><span style="color: #888a85;">instead of `C-x o'</span>
(<span style="color: #729fcf; font-weight: bold;">when</span> (fboundp 'windmove-default-keybindings)
  (windmove-default-keybindings))

(custom-set-variables
  <span style="color: #888a85;">;; </span><span style="color: #888a85;">custom-set-variables was added by Custom.</span>
  <span style="color: #888a85;">;; </span><span style="color: #888a85;">If you edit it by hand, you could mess it up, so be careful.</span>
  <span style="color: #888a85;">;; </span><span style="color: #888a85;">Your init file should contain only one such instance.</span>
  <span style="color: #888a85;">;; </span><span style="color: #888a85;">If there is more than one, they won't work right.</span>
 '(frame-background-mode (quote dark)))
(custom-set-faces
 <span style="color: #888a85;">;; </span><span style="color: #888a85;">custom-set-faces was added by Custom.</span>
 <span style="color: #888a85;">;; </span><span style="color: #888a85;">If you edit it by hand, you could mess it up, so be careful.</span>
 <span style="color: #888a85;">;; </span><span style="color: #888a85;">Your init file should contain only one such instance.</span>
 <span style="color: #888a85;">;; </span><span style="color: #888a85;">If there is more than one, they won't work right.</span>
 '(ahs-plugin-defalt-face ((t nil)))
 '(ethan-wspace-face ((t (<span style="color: #729fcf;">:background</span> <span style="color: #ad7fa8; font-style: italic;">"#2e3434"</span>))))
 '(flymake-errline ((((class color)) (<span style="color: #729fcf;">:underline</span> <span style="color: #ad7fa8; font-style: italic;">"Red"</span>))))
 '(flymake-warnline ((((class color)) (<span style="color: #729fcf;">:underline</span> <span style="color: #ad7fa8; font-style: italic;">"Orange"</span>))))
 '(hl-line ((t (<span style="color: #729fcf;">:background</span> <span style="color: #ad7fa8; font-style: italic;">"gray14"</span>))))
 '(hl-sexp-face ((t (<span style="color: #729fcf;">:background</span> <span style="color: #ad7fa8; font-style: italic;">"gray14"</span>))))
 '(js2-function-param-face ((((class color)) (<span style="color: #729fcf;">:foreground</span> <span style="color: #ad7fa8; font-style: italic;">"Green"</span>))))
 '(smerge-refined-change ((t (<span style="color: #729fcf;">:background</span> <span style="color: #ad7fa8; font-style: italic;">"black"</span>)))))

<span style="color: #888a85;">;; </span><span style="color: #888a85;">(require 'timing)</span>
<span style="color: #888a85;">;; </span><span style="color: #888a85;">(message "Spent %.2f seconds executing .emacs.d/init.el."</span>
<span style="color: #888a85;">;;          </span><span style="color: #888a85;">(time-difference *emacs-load-start* (current-time)))</span>
(put 'narrow-to-region 'disabled nil)

(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">indent-buffer</span> ()
  <span style="color: #888a85;">"Indent the everything in the current buffer."</span>
  (interactive)
  (indent-region (point-min) (point-max)))

(add-hook 'magit-log-edit-mode-hook 'auto-fill-mode)

(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">f</span>)
(<span style="color: #729fcf; font-weight: bold;">require</span> '<span style="color: #8ae234;">s</span>)

(<span style="color: #729fcf; font-weight: bold;">defun</span> <span style="color: #edd400; font-weight: bold;">download-file</span> (url directory file-name)
  <span style="color: #888a85;">"Download the file at URL into DIRECTORY.</span>
<span style="color: #888a85;">The FILE-NAME defaults to the one used in the URL."</span>
  (interactive
   <span style="color: #888a85;">;; </span><span style="color: #888a85;">We're forced to let-bind url here since we access it before</span>
   <span style="color: #888a85;">;; </span><span style="color: #888a85;">interactive binds the function parameters.</span>
   (<span style="color: #729fcf; font-weight: bold;">let</span> ((url (read-from-minibuffer <span style="color: #ad7fa8; font-style: italic;">"URL: "</span>)))
     (list
      url
      (read-directory-name <span style="color: #ad7fa8; font-style: italic;">"Destination dir: "</span>)
      <span style="color: #888a85;">;; </span><span style="color: #888a85;">deliberately not using read-file-name since that inludes the directory</span>
      (read-from-minibuffer
       <span style="color: #ad7fa8; font-style: italic;">"File name: "</span>
       (car (last (s-split <span style="color: #ad7fa8; font-style: italic;">"/"</span> url)))))))
  (<span style="color: #729fcf; font-weight: bold;">let</span> ((destination (f-join directory file-name)))
    (url-copy-file url destination 't)
    (find-file destination)))
</pre>

</div>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2013-10-06T19:21+0100</p>
<p class="author">Author: Wilfred Hughes</p>
<p class="creator"><a href="http://orgmode.org">Org</a> version 7.9.3f with <a href="http://www.gnu.org/software/emacs/">Emacs</a> version 24</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
